# CDSAgent 0.1.0-MVP Task Tracking
# Version: 1.0
# Last Updated: 2025-10-24T18:00:00
#
# This file tracks all implementation tasks with metadata, dependencies, and status.
# Each task links to PRDs, Issues, and detailed task specifications.

project:
  name: CDSAgent
  version: 0.1.0-MVP
  start_date: 2025-10-19
  target_release: 2025-12-31
  repository: https://github.com/lwyBZss8924d/CDSAgent

# Milestone definitions
milestones:
  M0:
    name: "Foundation Setup"
    target_date: "2025-10-19"
    status: completed
    description: "Infrastructure, worktrees, documentation framework"
    deliverables:
      - Git worktree infrastructure
      - PRD documentation suite
      - Task specifications
      - Development environment

  M1:
    name: "API Contracts & Parity"
    target_date: "2025-10-26"  # Week 1
    status: completed  # ✅ Completed 2025-10-25
    completed_date: "2025-10-25"
    description: "Define all interfaces and validation methodology"
    critical_path:
      - T-05-01-jsonrpc-schema  # ✅ Completed 2025-10-19
      - T-06-01-parity-methodology  # ✅ Completed 2025-10-24
      - T-05-02-typescript-bindings  # ✅ Completed 2025-10-23
      - T-05-03-error-catalogue  # ✅ Completed 2025-10-25
    pr_merged:
      - T-05-01-jsonrpc-schema: 3
      - T-05-02-typescript-bindings: 5
      - T-06-01-parity-methodology: 4
    deliverables:
      - JSON-RPC API schemas  # ✅ Completed
      - LocAgent parity methodology  # ✅ Completed with Phase 2 baselines
      - TypeScript type bindings  # ✅ Completed
      - Error code catalogue  # ✅ Completed

  M2:
    name: "Core Indexing Prototype"
    target_date: "2025-11-09"  # Week 2-3
    status: not_started
    description: "Working graph builder and sparse index"
    critical_path:
      - T-02-01-graph-builder
      - T-02-02-sparse-index
    deliverables:
      - Python AST parsing with tree-sitter
      - Graph construction (4 nodes, 4 edges)
      - BM25 + name/ID search index

  M3:
    name: "Service & CLI Alpha"
    target_date: "2025-11-23"  # Week 4-5
    status: not_started
    description: "JSON-RPC service and CLI tools"
    critical_path:
      - T-02-03-service-layer
      - T-03-01-core-commands
    deliverables:
      - JSON-RPC server (4 endpoints)
      - CLI tools (search, traverse, retrieve)
      - Basic integration tests

  M4:
    name: "Agent Integration Beta"
    target_date: "2025-12-07"  # Week 6-7
    status: not_started
    description: "Claude Agent SDK integration with hooks"
    critical_path:
      - T-04-01-agent-sdk
      - T-04-02-prompt-design
      - T-04-03-hooks
    deliverables:
      - Agent SDK bootstrap
      - Code localization prompts
      - PreToolUse/PostToolUse hooks
      - Sample transcripts

  M5:
    name: "Production Release Candidate"
    target_date: "2025-12-31"  # Week 8-10
    status: not_started
    description: "Deployment, testing, and optimization"
    critical_path:
      - T-07-01-docker-compose
      - T-08-03-parity-validation
      - T-08-04-benchmark-testing
    deliverables:
      - Docker Compose setup
      - Parity validation (>80% accuracy)
      - Performance benchmarks
      - Deployment documentation

# Task definitions with full metadata
tasks:
  # ==================== Phase 0: Foundation (Complete) ====================

  T-00-01-worktree-setup:
    title: "Git Worktree Development Infrastructure"
    milestone: M0
    week: 0
    priority: P0
    status: completed
    owner: Tech Lead
    branch: feat/dev-environment-setup
    worktree: null  # Main repo task
    completed_date: "2025-10-19"
    pr: "https://github.com/lwyBZss8924d/CDSAgent/pull/2"
    git_commits:
      - bd887f6: "feat(infra): setup git worktree development workflow"
      - 6c1b45a: "chore(infra): finalize worktree setup and sync planning artifacts"
    artifacts:
      - .worktrees/ (7 task branches)
      - scripts/worktree-symlink.sh
      - docs/WORKTREE_WORKFLOW.md
      - DEVELOPMENT_STATUS.md

  # ==================== Phase 1: API Contracts & Parity (Week 1) ====================

  T-05-01-jsonrpc-schema:
    title: "JSON-RPC Schema Definition & Validation"
    milestone: M1
    week: 1
    priority: P0
    status: completed
    owner: [Claude Code Agent, Rust Dev 1, TS Dev 1]
    duration_days: 1  # Completed in 1 day (ahead of 3-day estimate)
    worktree: .worktrees/T-05-01-jsonrpc-schema
    branch: feat/task/T-05-01-jsonrpc-schema
    symlink: ~/dev-space/CDSAgent-T-05-01-jsonrpc-schema
    completed_date: "2025-10-19"
    pr: "https://github.com/lwyBZss8924d/CDSAgent/pull/3"
    merged_commit: f33d2cd33293c43b566279ffcc1ee6546816a34d

    specs:
      prds:
        - spacs/prd/0.1.0-MVP-PRDs-v0/05-api-specifications.md
        - spacs/prd/0.1.0-MVP-PRDs-v0/02-cds-index-service.md
      issues:
        - spacs/issues/04-0.1.0-mvp/05-api-contracts.md
      tasks:
        - spacs/tasks/0.1.0-mvp/05-api-contracts/T-05-01-jsonrpc-schema.md
        - spacs/tasks/0.1.0-mvp/05-api-contracts/README.md

    dependencies:
      requires: []  # No prerequisites
      blocks:
        - T-02-03-service-layer
        - T-05-02-typescript-bindings
        - T-03-01-cli-commands

    deliverables:
      - docs/api/jsonrpc-schema.json
      - docs/api/README.md
      - docs/api/error-codes.md
      - docs/api/versioning.md
      - crates/cds-index/tests/service_contract_tests.rs (30 tests)
      - tests/fixtures/api/*

    acceptance_criteria:
      - "✅ Schema file published and referenced from docs"
      - "✅ Service contract tests fail if response deviates from schema"
      - "✅ CLI integration test validates JSON output via schema"
      - "✅ Schema versioning plan recorded (v0.1.0)"

    worklog_path: .artifacts/spec-tasks-T-05-01-jsonrpc-schema/worklogs/

    git_commits:
      - 890b01e: "feat(api): T-05-01 - implement JSON-RPC schema validation"
      - 5ff7db3: "fix(api): address schema validation and documentation issues"
      - 934bcd9: "fix(tests): add embedded schema validation tests and complete T-05-01"
      - 747b483: "docs(worklog): complete T-05-01 worklog and metadata tracking"
      - db543df: "fix(tests): use compiled schema validation against full jsonrpc-schema.json"

    metrics:
      estimated_hours: 24
      actual_hours: 5.5
      lines_added: 3850
      lines_deleted: 49
      tests_added: 30
      test_pass_rate: 1.0

  T-05-02-typescript-bindings:
    title: "TypeScript Client Types & SDK Bindings"
    milestone: M1
    week: 1
    priority: P0
    status: completed
    owner: TypeScript Dev 1
    duration_days: 3
    worktree: .worktrees/T-05-02-typescript-bindings
    branch: feat/task/T-05-02-typescript-bindings
    completed_date: "2025-10-23"
    merged_pr: 5

    specs:
      prds:
        - spacs/prd/0.1.0-MVP-PRDs-v0/05-api-specifications.md
      issues:
        - spacs/issues/04-0.1.0-mvp/05-api-contracts.md
      tasks:
        - spacs/tasks/0.1.0-mvp/05-api-contracts/T-05-02-typescript-bindings.md

    dependencies:
      requires:
        - T-05-01-jsonrpc-schema
      blocks:
        - T-04-01-agent-sdk

    deliverables:
      - cds-agent/src/client/jsonrpc.ts
      - cds-agent/src/types/api.ts
      - cds-agent/src/utils/config.ts
      - cds-agent/tests/jsonrpc-client.test.ts

    acceptance_criteria:
      - "✅ Client methods compile and work with ID validation"
      - "✅ TypeScript types align with jsonrpc-schema.json"
      - "✅ Unit tests cover success, error, and security scenarios (12 tests)"
      - "✅ Client integrated with agent entrypoint"

    worklog_path: .artifacts/spec-tasks-T-05-02-typescript-bindings/worklogs/

    git_commits:
      - 3549909: "feat(agent): T-05-02 - complete TypeScript client bindings & SDK integration"
      - 38c1e75: "fix(client): validate JSON-RPC response IDs and fix TypeScript configuration"

    metrics:
      hours_spent: 9.5
      lines_added: 3060
      lines_deleted: 295
      tests_added: 12
      test_pass_rate: 1.0

  T-06-01-parity-methodology:
    title: "LocAgent Parity Validation Methodology"
    milestone: M1
    week: 1
    priority: P0
    status: completed
    owner: Rust Lead
    duration_days: 4  # Phase 1: 2 days, Phase 2: 2 days (2025-10-24)
    completed_date: "2025-10-24"  # Phase 1: 2025-10-22 (PR #4), Phase 2: 2025-10-24 (baseline extraction)
    merged_pr: 4  # Phase 1
    worktree: .worktrees/T-06-01-parity-methodology
    branch: feat/task/T-06-01-parity-methodology

    specs:
      prds:
        - spacs/prd/0.1.0-MVP-PRDs-v0/06-rust-refactoring-plan.md
      issues:
        - spacs/issues/04-0.1.0-mvp/06-refactor-parity.md
      tasks:
        - spacs/tasks/0.1.0-mvp/06-refactor-parity/T-06-01-parity-methodology.md

    dependencies:
      requires: []
      blocks:
        - T-02-01-graph-builder

    deliverables:
      # Phase 1 (PR #4)
      - docs/parity-validation-methodology.md
      - scripts/parity-check.sh
      - tests/fixtures/parity/golden_outputs/graph_locagent.json
      - tests/fixtures/parity/locagent_version.txt
      - tmp/extract-locagent-baseline.py
      # Phase 2 (2025-10-24)
      - tests/fixtures/parity/golden_outputs/graph_django__django-10914.json
      - tests/fixtures/parity/golden_outputs/graph_scikit-learn__scikit-learn-10297.json
      - tests/fixtures/parity/golden_outputs/graph_matplotlib__matplotlib-18869.json
      - tests/fixtures/parity/golden_outputs/graph_pytest-dev__pytest-11143.json
      - tests/fixtures/parity/golden_outputs/graph_psf__requests-1963.json
      - tests/fixtures/parity/golden_outputs/traverse_samples.jsonl
      - tests/fixtures/parity/golden_outputs/search_queries.jsonl
      - tests/fixtures/parity/golden_outputs/performance_baselines.json
      - tests/fixtures/parity/golden_outputs/README.md
      - tests/fixtures/parity/swe-bench-lite/samples.yaml
      - scripts/swe-lite
      - scripts/fetch-swe-bench-lite.py
      - scripts/select-swe-bench-instances.py
      - scripts/extract-parity-baseline.py
      - scripts/extract-search-baseline.py
      - scripts/extract-traverse-baseline.py
      - scripts/benchmark-performance.py

    acceptance_criteria:
      - "✅ Methodology document published with 10 sections"
      - "✅ Graph baselines extracted for 6 repos (LocAgent + 5 SWE-bench)"
      - "✅ Traverse baselines extracted for 60 scenarios (10 × 6 repos)"
      - "⚠️ Search baselines extracted for LocAgent only (llama-index limitation)"
      - "⚠️ Performance baselines extracted for LocAgent only (llama-index limitation)"
      - "✅ Automation scripts created (swe-lite CLI wrapper)"
      - "✅ Known limitations documented in methodology + README"

    worklog_path: .artifacts/spec-tasks-T-06-01-parity-methodology/worklogs/

    git_commits:
      - fb1a625: "feat(parity): T-06-01 Phase 1 - establish parity validation methodology"
      - d00ce54: "feat(parity): T-06-01 Phase 2 - extract comprehensive baselines with llama-index limitation documented"

    metrics:
      estimated_hours: 32  # 4 days × 8 hours
      actual_hours: 28
      baselines_extracted:
        graph: "6/6 repos (658 to 6,876 nodes)"
        traverse: "60/60 scenarios"
        search: "1/6 repos (LocAgent only)"
        performance: "1/6 repos (LocAgent only)"

  T-05-03-error-catalogue:
    title: "Error Code Catalogue & Documentation"
    milestone: M1
    week: 1
    priority: P1
    status: completed
    owner: PM/Tech Writer
    duration_days: 1
    worktree: null
    branch: main
    completed_date: "2025-10-24"

    specs:
      tasks:
        - spacs/tasks/0.1.0-mvp/05-api-contracts/T-05-03-error-catalogue.md

    dependencies:
      requires:
        - T-05-01-jsonrpc-schema
      blocks: []

    deliverables:
      - docs/api/error-codes.md  # ✅ Completed (created in T-05-01)
      - Updated README with error handling  # ✅ Completed (line 205)

    acceptance_criteria:
      - "✅ Every error code defined in PRD-05 documented with description and remediation"
      - "✅ CLI and agent reference documentation updated to link to error catalogue"
      - "✅ Process for adding new error codes established (checklist in docs)"

    worklog_path: .artifacts/spec-tasks-T-05-03-error-catalogue/worklogs/

    git_commits:
      - 477d022: "docs(api): T-05-03 - finalize error catalogue with task tracking"

    metrics:
      estimated_hours: 8
      actual_hours: 1
      lines_added: 358
      lines_deleted: 0
      tests_added: 0
      test_pass_rate: null

  # ==================== Phase 2: Core Indexing (Week 2-3) ====================

  T-02-01-graph-builder:
    title: "Graph Builder - AST Parsing & Construction"
    milestone: M2
    week: 2
    priority: P0
    status: completed
    owner: Rust Dev 1
    duration_days: 6  # Completed in 6 days (2025-10-24 to 2025-10-30)
    worktree: .worktrees/T-02-01-graph-builder
    branch: feat/task/T-02-01-graph-builder
    symlink: ~/dev-space/CDSAgent-T-02-01-graph-builder
    completed_date: "2025-10-30"
    pr: "https://github.com/lwyBZss8924d/CDSAgent/pull/6"

    specs:
      prds:
        - spacs/prd/0.1.0-MVP-PRDs-v0/02-cds-index-service.md
        - spacs/prd/0.1.0-MVP-PRDs-v0/06-rust-refactoring-plan.md
      issues:
        - spacs/issues/04-0.1.0-mvp/02-index-core/01-graph-build.md
      tasks:
        - spacs/tasks/0.1.0-mvp/02-index-core/T-02-01-graph-builder.md

    dependencies:
      requires:
        - T-06-01-parity-methodology
      blocks:
        - T-02-02-sparse-index
        - T-03-01-core-commands

    deliverables:
      - crates/cds-index/src/graph/parser.rs
      - crates/cds-index/src/graph/builder/ (10 modules, 2,037 lines)
      - crates/cds-index/src/graph/traversal.rs
      - crates/cds-index/tests/graph_builder_tests.rs (23 unit tests)
      - crates/cds-index/tests/graph_parity_tests.rs (6 fixtures validation)
      - API documentation (crates/cds-index/src/graph/mod.rs)

    acceptance_criteria:
      - "✅ Parses Python repos with 4 node types + 4 edge types"
      - "✅ Fully-qualified names match LocAgent format"
      - "✅ Unit tests cover edge cases (23 tests, ~82% coverage)"
      - "✅ Graph parity ≤2% variance (all 6 fixtures pass)"

    worklog_path: .artifacts/spec-tasks-T-02-01-graph-builder/worklogs/

    git_commits:
      - cd863be: "checkpoint(worklog): T-02-01 Day 6 - initialize 2025-10-30 session worklogs"
      - 72f9db5: "feat(graph): T-02-01 complete - parity, coverage, docs"
      - c0b8f2c: "checkpoint(worklog): T-02-01 Day 6 complete"
      - af5a537: "chore(config): update Claude auto-approval settings for checkpoint workflow"

    metrics:
      estimated_hours: 40
      actual_hours: 39
      lines_added: 8884
      lines_deleted: 353
      files_modified: 74
      tests_added: 23
      test_coverage: 0.82
      parity_variance_max: 0.0129  # +1.29% on pytest invokes

  T-02-02-sparse-index:
    title: "Sparse Index - Name/ID + BM25 Search"
    milestone: M2
    week: 2
    priority: P0
    status: not_started
    owner: Rust Dev 2
    duration_days: 4
    worktree: .worktrees/T-02-02-sparse-index
    branch: feat/task/T-02-02-sparse-index
    symlink: ~/dev-space/CDSAgent-T-02-02-sparse-index

    specs:
      prds:
        - spacs/prd/0.1.0-MVP-PRDs-v0/02-cds-index-service.md
      issues:
        - spacs/issues/04-0.1.0-mvp/02-index-core/02-sparse-index.md
      tasks:
        - spacs/tasks/0.1.0-mvp/02-index-core/T-02-02-sparse-index.md

    dependencies:
      requires:
        - T-02-01-graph-builder
      blocks:
        - T-02-03-service-layer
        - T-03-01-core-commands

    deliverables:
      - crates/cds-index/src/index/name_index.rs
      - crates/cds-index/src/index/bm25.rs
      - Performance benchmarks (<500ms p95 search latency)

    acceptance_criteria:
      - Upper index (name/ID HashMap) with prefix matching
      - Lower index (BM25 k1=1.5, b=0.75)
      - Search latency <500ms p95
      - Index build <5s for 1K files

    worklog_path: .artifacts/spec-tasks-T-02-02/worklogs/

  T-02-04-serialization:
    title: "Graph & Index Serialization"
    milestone: M2
    week: 3
    priority: P1
    status: not_started
    owner: Rust Dev 2
    duration_days: 2
    worktree: .worktrees/T-02-02-sparse-index  # Same worktree
    branch: feat/task/T-02-02-sparse-index

    specs:
      issues:
        - spacs/issues/04-0.1.0-mvp/02-index-core/04-serialization-fixtures.md
      tasks:
        - spacs/tasks/0.1.0-mvp/02-index-core/T-02-04-serialization.md

    dependencies:
      requires:
        - T-02-01-graph-builder
        - T-02-02-sparse-index
      blocks:
        - T-03-03-integration-tests
        - T-07-02-env-config

    deliverables:
      - crates/cds-index/src/persistence/
      - Test fixtures under tests/fixtures/

  # ==================== Phase 3: Service & CLI (Week 3-4) ====================

  T-02-03-service-layer:
    title: "JSON-RPC Service Layer Implementation"
    milestone: M3
    week: 3
    priority: P0
    status: not_started
    owner: Rust Dev 1
    duration_days: 4
    worktree: .worktrees/T-02-03-service-layer
    branch: feat/task/T-02-03-service-layer
    symlink: ~/dev-space/CDSAgent-T-02-03-service-layer

    specs:
      prds:
        - spacs/prd/0.1.0-MVP-PRDs-v0/02-cds-index-service.md
      issues:
        - spacs/issues/04-0.1.0-mvp/02-index-core/03-service-layer.md
      tasks:
        - spacs/tasks/0.1.0-mvp/02-index-core/T-02-03-service-layer.md

    dependencies:
      requires:
        - T-02-01-graph-builder
        - T-02-02-sparse-index
        - T-05-01-jsonrpc-schema
      blocks:
        - T-03-01-core-commands
        - T-04-01-agent-sdk

    deliverables:
      - crates/cds-index/src/service/handlers.rs
      - crates/cds-index/src/service/server.rs
      - Integration tests

    acceptance_criteria:
      - JSON-RPC service with 4 endpoints
      - Error handling per schema
      - Integration tests pass

    worklog_path: .artifacts/spec-tasks-T-02-03/worklogs/

  T-03-01-core-commands:
    title: "CLI Core Commands Implementation"
    milestone: M3
    week: 4
    priority: P0
    status: not_started
    owner: Rust Dev 2
    duration_days: 3
    worktree: .worktrees/T-03-01-cli-commands
    branch: feat/task/T-03-01-cli-commands
    symlink: ~/dev-space/CDSAgent-T-03-01-cli-commands

    specs:
      prds:
        - spacs/prd/0.1.0-MVP-PRDs-v0/03-cds-tools-cli.md
      issues:
        - spacs/issues/04-0.1.0-mvp/03-cli-tools/01-command-impl.md
      tasks:
        - spacs/tasks/0.1.0-mvp/03-cli-tools/T-03-01-core-commands.md

    dependencies:
      requires:
        - T-02-03-service-layer
      blocks:
        - T-04-01-agent-sdk

    deliverables:
      - crates/cds-tools/src/commands/ (search, traverse, retrieve)
      - crates/cds-tools/src/client/jsonrpc_client.rs
      - Output formatters (JSON, text, tree)

    worklog_path: .artifacts/spec-tasks-T-03-01/worklogs/

  T-03-02-output-format:
    title: "CLI Output Formatting"
    milestone: M3
    week: 4
    priority: P1
    status: not_started
    owner: Rust Dev 2
    duration_days: 2
    worktree: .worktrees/T-03-01-cli-commands
    branch: feat/task/T-03-01-cli-commands

    specs:
      tasks:
        - spacs/tasks/0.1.0-mvp/03-cli-tools/T-03-02-output-format.md

    dependencies:
      requires:
        - T-03-01-core-commands
      blocks: []

    deliverables:
      - Output formatters (JSON, tree, text)
      - Color-coded terminal output

  # ==================== Phase 4: Agent Integration (Week 5-7) ====================

  T-04-01-agent-sdk:
    title: "Agent SDK Bootstrap"
    milestone: M4
    week: 5
    priority: P0
    status: not_started
    owner: TS Dev 1
    duration_days: 2
    worktree: .worktrees/T-04-01-agent-sdk
    branch: feat/task/T-04-01-agent-sdk
    symlink: ~/dev-space/CDSAgent-T-04-01-agent-sdk

    specs:
      prds:
        - spacs/prd/0.1.0-MVP-PRDs-v0/04-cds-agent-integration.md
      issues:
        - spacs/issues/04-0.1.0-mvp/04-agent-integration/01-sdk-bootstrap.md
      tasks:
        - spacs/tasks/0.1.0-mvp/04-agent-integration/T-04-01-sdk-bootstrap.md

    dependencies:
      requires:
        - T-03-01-core-commands
        - T-05-02-typescript-bindings
      blocks:
        - T-04-02-prompt-design
        - T-04-03-hooks

    deliverables:
      - cds-agent/src/agent-config.ts
      - cds-agent/src/tools/ (CLI tool wrappers)
      - Basic agent configuration

    worklog_path: .artifacts/spec-tasks-T-04-01/worklogs/

  T-04-02-prompt-design:
    title: "Agent Prompt Design"
    milestone: M4
    week: 5
    priority: P0
    status: not_started
    owner: TS Dev 1
    duration_days: 2
    worktree: .worktrees/T-04-02-prompt-design
    branch: feat/task/T-04-02-prompt-design
    symlink: ~/dev-space/CDSAgent-T-04-02-prompt-design

    specs:
      tasks:
        - spacs/tasks/0.1.0-mvp/04-agent-integration/T-04-02-prompt-design.md

    dependencies:
      requires:
        - T-04-01-agent-sdk
      blocks:
        - T-04-04-sample-transcripts

    deliverables:
      - cds-agent/src/system-prompt.ts
      - Tool descriptions and examples
      - Multi-step reasoning patterns

    worklog_path: .artifacts/spec-tasks-T-04-02/worklogs/

  T-04-03-hooks:
    title: "Agent Hooks Implementation"
    milestone: M4
    week: 6
    priority: P0
    status: not_started
    owner: TS Dev 1
    duration_days: 3
    worktree: .worktrees/T-04-01-agent-sdk  # Same as T-04-01
    branch: feat/task/T-04-01-agent-sdk

    specs:
      tasks:
        - spacs/tasks/0.1.0-mvp/04-agent-integration/T-04-03-hooks.md

    dependencies:
      requires:
        - T-04-01-agent-sdk
        - T-03-01-core-commands
      blocks:
        - T-04-04-sample-transcripts
        - T-08-02-integration-tests

    deliverables:
      - cds-agent/src/hooks/pre-tool-use.ts
      - cds-agent/src/hooks/post-tool-use.ts
      - Context compression logic

    worklog_path: .artifacts/spec-tasks-T-04-03/worklogs/

  T-04-04-sample-transcripts:
    title: "Sample Agent Transcripts"
    milestone: M4
    week: 7
    priority: P1
    status: not_started
    owner: TS Dev 1
    duration_days: 2
    worktree: .worktrees/T-04-02-prompt-design
    branch: feat/task/T-04-02-prompt-design

    specs:
      tasks:
        - spacs/tasks/0.1.0-mvp/04-agent-integration/T-04-04-sample-transcripts.md

    dependencies:
      requires:
        - T-04-02-prompt-design
        - T-04-03-hooks
      blocks:
        - T-08-02-integration-tests

    deliverables:
      - docs/transcripts/ (5 sample sessions)
      - Annotated agent workflows

  # ==================== Phase 5: Testing (Week 6-10, Continuous) ====================

  T-08-01-unit-tests:
    title: "Unit Tests (Continuous)"
    milestone: M2-M5
    week: 6-10
    priority: P1
    status: not_started
    owner: All Devs
    duration_days: continuous
    worktree: null  # Happens in all worktrees
    branch: all

    specs:
      tasks:
        - spacs/tasks/0.1.0-mvp/08-testing/T-08-01-unit-tests.md

    dependencies:
      requires: []
      blocks: []

    acceptance_criteria:
      - Code coverage >80%
      - All unit tests pass
      - Property-based tests for critical paths

  T-08-02-integration-tests:
    title: "Integration Tests"
    milestone: M4
    week: 7
    priority: P0
    status: not_started
    owner: Rust Dev 2
    duration_days: 3
    worktree: null
    branch: main

    specs:
      tasks:
        - spacs/tasks/0.1.0-mvp/08-testing/T-08-02-integration-tests.md

    dependencies:
      requires:
        - T-04-03-hooks
        - T-04-04-sample-transcripts
      blocks: []

    deliverables:
      - End-to-end integration tests
      - CLI workflow tests
      - Agent workflow tests

  T-08-03-parity-validation:
    title: "LocAgent Parity Validation"
    milestone: M5
    week: 9
    priority: P0
    status: not_started
    owner: Rust Lead
    duration_days: 3
    worktree: null
    branch: main

    specs:
      tasks:
        - spacs/tasks/0.1.0-mvp/08-testing/T-08-03-parity-validation.md

    dependencies:
      requires:
        - T-02-01-graph-builder
        - T-02-02-sparse-index
        - T-06-01-parity-methodology
      blocks: []

    acceptance_criteria:
      - Graph variance ≤2% from LocAgent
      - Search overlap@10 ≥90% on 50 queries
      - Achieves >80% of LocAgent accuracy on SWE-bench Lite

  T-08-04-benchmark-testing:
    title: "Performance Benchmark Testing"
    milestone: M5
    week: 10
    priority: P0
    status: not_started
    owner: Rust Lead
    duration_days: 2
    worktree: null
    branch: main

    specs:
      tasks:
        - spacs/tasks/0.1.0-mvp/08-testing/T-08-04-benchmark-testing.md

    dependencies:
      requires:
        - T-02-01-graph-builder
        - T-02-02-sparse-index
      blocks: []

    acceptance_criteria:
      - Index build <5s for 1K files
      - Search latency <500ms p95
      - Traverse latency <1s p95
      - 2-5x faster than LocAgent Python

  # ==================== Phase 6: Deployment (Week 8-10) ====================

  T-07-01-docker-compose:
    title: "Docker Compose Setup"
    milestone: M5
    week: 8
    priority: P1
    status: not_started
    owner: DevOps/Rust Dev 1
    duration_days: 2
    worktree: .worktrees/T-07-01-docker-compose  # If needed
    branch: main

    specs:
      tasks:
        - spacs/tasks/0.1.0-mvp/07-deployment/T-07-01-docker-compose.md

    dependencies:
      requires:
        - T-02-03-service-layer
        - T-03-01-core-commands
      blocks: []

    deliverables:
      - docker-compose.yml
      - Dockerfile for cds-index service
      - Dockerfile for cds-tools

  T-07-02-env-config:
    title: "Environment Configuration"
    milestone: M5
    week: 8
    priority: P1
    status: not_started
    owner: DevOps
    duration_days: 1
    worktree: null
    branch: main

    specs:
      tasks:
        - spacs/tasks/0.1.0-mvp/07-deployment/T-07-02-env-config.md

    dependencies:
      requires:
        - T-02-04-serialization
      blocks: []

    deliverables:
      - .env.example
      - docs/deployment/configuration.md

  T-07-03-monitoring:
    title: "Monitoring & Health Checks"
    milestone: M5
    week: 9
    priority: P1
    status: not_started
    owner: DevOps
    duration_days: 2
    worktree: null
    branch: main

    specs:
      tasks:
        - spacs/tasks/0.1.0-mvp/07-deployment/T-07-03-monitoring.md

    dependencies:
      requires:
        - T-02-03-service-layer
      blocks: []

    deliverables:
      - Health check endpoint
      - Logging infrastructure
      - Metrics collection

  T-07-04-deployment-docs:
    title: "Deployment Documentation"
    milestone: M5
    week: 10
    priority: P1
    status: not_started
    owner: Tech Writer
    duration_days: 1
    worktree: null
    branch: main

    specs:
      tasks:
        - spacs/tasks/0.1.0-mvp/07-deployment/T-07-04-docs.md

    dependencies:
      requires:
        - T-07-01-docker-compose
        - T-07-02-env-config
        - T-07-03-monitoring
      blocks: []

    deliverables:
      - docs/deployment/README.md
      - Quick start guide
      - Troubleshooting guide

# Workflow metadata tracking
workflows:
  current_phase: "M2 - Core Indexing Prototype (In Progress)"
  active_tasks:
    - T-02-01-graph-builder  # PR #6 awaiting review (completed 2025-10-30)

  completed_tasks:
    - T-00-01-worktree-setup  # M0
    - T-05-01-jsonrpc-schema  # M1, PR #3 merged 2025-10-19
    - T-05-02-typescript-bindings  # M1, PR #5 merged 2025-10-23
    - T-06-01-parity-methodology  # M1, PR #4 merged 2025-10-22, Phase 2 completed 2025-10-24
    - T-05-03-error-catalogue  # M1, completed 2025-10-25

  blocked_tasks: []

  next_up:
    - T-02-02-sparse-index  # Week 2, M2 (requires T-02-01 ✅ - DEPENDENCY CLEARED, PR #6 pending review)

# Artifact tracking
artifacts:
  worklogs_base: .artifacts/spec-tasks-*/worklogs/
  git_notes_prefix: "spec-tasks/"

  template:
    worklog_structure: |
      .artifacts/spec-tasks-{TASK_ID}/
      ├── worklogs/
      │   ├── {date}-work-summary.md
      │   ├── {date}-commit-log.md
      │   └── {date}-notes.md
      ├── metadata.yaml
      └── git-refs.txt

# Comments and notes
comments:
  - "2025-10-19: Initial TODO.yaml created with all task definitions"
  - "2025-10-19: M0 milestone completed - worktree infrastructure ready"
  - "2025-10-24: M1 milestone completed - API contracts and parity baseline established"
  - "2025-10-24: T-06-01 Phase 2 baselines extracted (6 graphs, 60 traversals, 50 search queries)"
  - "2025-10-24: Known limitation documented - llama-index retriever requires .py at repo root"
  - "2025-10-24: Fixed benchmark-performance.py with dummy __init__.py workaround (d78c687)"
  - "2025-10-30: T-02-01 completed - Graph Builder with ≤2% parity across 6 fixtures"
  - "2025-10-30: PR #6 created - 23 unit tests, ~82% coverage, 8,884 lines added"
  - "2025-10-30: M2 milestone in progress - T-02-02 dependency cleared"
  - "Next action: T-02-02 owner can start Sparse Index implementation (blocked on T-02-01 PR #6 review)"
